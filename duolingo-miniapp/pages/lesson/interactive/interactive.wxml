<!-- Interactive Lesson Player -->
<view class="page">
  <!-- é¡¶éƒ¨è¿›åº¦æ¡ -->
  <view class="top-bar">
    <view class="progress-container">
      <text class="lesson-number">{{currentQuestion + 1}}/{{totalQuestions}}</text>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{(currentQuestion + 1) / totalQuestions * 100}}%"></view>
      </view>
    </view>
    <text class="close-btn" bindtap="handleQuit">âœ•</text>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <scroll-view class="content" scroll-y="true">
    <!-- é—®é¢˜åŒºåŸŸ -->
    <view class="question-section">
      <text class="question-number">Question {{currentQuestion + 1}}</text>
      <text class="question-text">{{currentLesson.question}}</text>
      <text class="question-hint" wx:if="{{currentLesson.hint}}">ðŸ’¡ {{currentLesson.hint}}</text>
    </view>

    <!-- éŸ³é¢‘æ’­æ”¾ -->
    <view class="audio-section" wx:if="{{currentLesson.audioUrl}}">
      <view class="audio-player" bindtap="handlePlayAudio">
        <text class="audio-icon">ðŸ”Š</text>
        <text class="audio-text">Listen</text>
      </view>
    </view>

    <!-- ç­”æ¡ˆé€‰é¡¹ -->
    <view class="answers-section" wx:if="{{!answered}}">
      <view class="answer-option {{selectedAnswer === index ? 'selected' : ''}}" 
            wx:for="{{currentLesson.options}}" 
            wx:key="index"
            bindtap="handleSelectAnswer"
            data-index="{{index}}">
        <view class="answer-letter">{{String.fromCharCode(65 + index)}}</view>
        <text class="answer-text">{{item}}</text>
      </view>
    </view>

    <!-- ç»“æžœåé¦ˆ -->
    <view class="feedback-section" wx:if="{{answered}}">
      <view class="feedback {{isCorrect ? 'correct' : 'incorrect'}}">
        <text class="feedback-icon">{{isCorrect ? 'âœ“' : 'âœ—'}}</text>
        <text class="feedback-text">{{isCorrect ? 'Correct!' : 'Incorrect!'}}</text>
        <text class="feedback-description">{{feedbackMessage}}</text>
      </view>
      <view class="correct-answer" wx:if="{{!isCorrect}}">
        <text class="correct-label">Correct answer:</text>
        <text class="correct-text">{{currentLesson.options[currentLesson.correctAnswer]}}</text>
      </view>
    </view>
  </scroll-view>

  <!-- åº•éƒ¨æŒ‰é’®åŒºåŸŸ -->
  <view class="button-section">
    <view class="btn btn-secondary" bindtap="handleSkip" wx:if="{{!answered}}">
      <text class="btn-text">SKIP</text>
    </view>
    <view class="btn btn-secondary" wx:if="{{answered && !isLast}}" bindtap="handleNext">
      <text class="btn-text">NEXT</text>
    </view>
    <view class="btn btn-primary" wx:if="{{answered && isLast}}" bindtap="handleFinish">
      <text class="btn-text">FINISH</text>
    </view>
  </view>
</view>
